
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Panos_security_policy - Ansible - W3cubDocs</title>
  
  <meta name="description" content=" New in version 2.3. ">
  <meta name="keywords" content="panos, security, policy, -, create, rule, on, devices, ansible">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ansible/panos_security_policy_module/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-e0f881b0fce8cbe96f33dadc355b7159d5d2912911231446d60eb8f9caffa802.css">
  <script type="text/javascript" src="/assets/application-8fc46316434047265cd383f02b8e7f434ed7dec4a59f920dd633deef8d488d1b.js"></script>
  <script src="/json/ansible.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible/" class="_nav-link" title="" style="margin-left:0;">Ansible</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
<h1 id="panos-security-policy">panos_security_policy - Create security rule policy on PanOS devices.</h1> <div class="versionadded" id="panos-security-policy-create-security-rule-policy-on-panos-devices"> <p><span class="versionmodified">New in version 2.3.</span></p> </div>  <ul class="simple"> <li><a class="reference internal" href="#deprecated" id="id1">DEPRECATED</a></li> <li><a class="reference internal" href="#synopsis" id="id2">Synopsis</a></li> <li><a class="reference internal" href="#requirements-on-host-that-executes-module" id="id3">Requirements (on host that executes module)</a></li> <li><a class="reference internal" href="#options" id="id4">Options</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#notes" id="id6">Notes</a></li> </ul>   <h2 id="deprecated">DEPRECATED</h2> <p>In 2.4 use <a class="reference internal" href="../panos_security_rule_module/#panos-security-rule"><span class="std std-ref">panos_security_rule</span></a> instead.</p>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Security policies allow you to enforce rules and take action, and can be as general or specific as needed. The policy rules are compared against the incoming traffic in sequence, and because the first rule that matches the traffic is applied, the more specific rules must precede the more general ones.</li> </ul>   <h2 id="requirements-on-host-that-executes-module">Requirements (on host that executes module)</h2>  <ul class="simple"> <li>pan-python can be obtained from PyPi <a class="reference external" href="https://pypi.python.org/pypi/pan-python" target="_blank">https://pypi.python.org/pypi/pan-python</a>
</li> <li>pandevice can be obtained from PyPi <a class="reference external" href="https://pypi.python.org/pypi/pandevice" target="_blank">https://pypi.python.org/pypi/pandevice</a>
</li> </ul>    <h2 id="options">Options</h2> <table> <tr> <th class="head">parameter</th> <th class="head">required</th> <th class="head">default</th> <th class="head">choices</th> <th class="head">comments</th> </tr> <tr> <td>action<br>
</td> <td>no</td> <td>allow</td> <td></td> <td> <div>Action to apply once rules maches.</div> </td> </tr> <tr> <td>antivirus<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Name of the already defined antivirus profile.</div> </td> </tr> <tr> <td>api_key<br>
</td> <td>no</td> <td></td> <td></td> <td> <div>API key that can be used instead of <em>username</em>/<em>password</em> credentials.</div> </td> </tr> <tr> <td>application<br>
</td> <td>no</td> <td>any</td> <td></td> <td> <div>List of applications.</div> </td> </tr> <tr> <td>commit<br>
</td> <td>no</td> <td>True</td> <td></td> <td> <div>Commit configuration if changed.</div> </td> </tr> <tr> <td>data_filtering<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Name of the already defined data_filtering profile.</div> </td> </tr> <tr> <td>description<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Description for the security rule.</div> </td> </tr> <tr> <td>destination<br>
</td> <td>no</td> <td>any</td> <td></td> <td> <div>List of destination addresses.</div> </td> </tr> <tr> <td>devicegroup<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Device groups are used for the Panorama interaction with Firewall(s). The group must exists on Panorama. If device group is not define we assume that we are contacting Firewall. </div> </td> </tr> <tr> <td>file_blocking<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Name of the already defined file_blocking profile.</div> </td> </tr> <tr> <td>from_zone<br>
</td> <td>no</td> <td>any</td> <td></td> <td> <div>List of source zones.</div> </td> </tr> <tr> <td>group_profile<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Security profile group that is already defined in the system. This property supersedes antivirus, vulnerability, spyware, url_filtering, file_blocking, data_filtering, and wildfire_analysis properties. </div> </td> </tr> <tr> <td>hip_profiles<br>
</td> <td>no</td> <td>any</td> <td></td> <td> <div>If you are using GlobalProtect with host information profile (HIP) enabled, you can also base the policy on information collected by GlobalProtect. For example, the user access level can be determined HIP that notifies the firewall about the user's local configuration. </div> </td> </tr> <tr> <td>ip_address<br>
</td> <td>yes</td> <td></td> <td></td> <td> <div>IP address (or hostname) of PAN-OS device being configured.</div> </td> </tr> <tr> <td>log_end<br>
</td> <td>no</td> <td>True</td> <td></td> <td> <div>Whether to log at session end.</div> </td> </tr> <tr> <td>log_start<br>
</td> <td>no</td> <td></td> <td></td> <td> <div>Whether to log at session start.</div> </td> </tr> <tr> <td>password<br>
</td> <td>yes</td> <td></td> <td></td> <td> <div>Password credentials to use for auth unless <em>api_key</em> is set.</div> </td> </tr> <tr> <td>rule_name<br>
</td> <td>yes</td> <td></td> <td></td> <td> <div>Name of the security rule.</div> </td> </tr> <tr> <td>rule_type<br>
</td> <td>no</td> <td>universal</td> <td></td> <td> <div>Type of security rule (version 6.1 of PanOS and above).</div> </td> </tr> <tr> <td>service<br>
</td> <td>no</td> <td>application-default</td> <td></td> <td> <div>List of services.</div> </td> </tr> <tr> <td>source<br>
</td> <td>no</td> <td>any</td> <td></td> <td> <div>List of source addresses.</div> </td> </tr> <tr> <td>source_user<br>
</td> <td>no</td> <td>any</td> <td></td> <td> <div>Use users to enforce policy for individual users or a group of users.</div> </td> </tr> <tr> <td>spyware<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Name of the already defined spyware profile.</div> </td> </tr> <tr> <td>tag<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Administrative tags that can be added to the rule. Note, tags must be already defined.</div> </td> </tr> <tr> <td>to_zone<br>
</td> <td>no</td> <td>any</td> <td></td> <td> <div>List of destination zones.</div> </td> </tr> <tr> <td>url_filtering<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Name of the already defined url_filtering profile.</div> </td> </tr> <tr> <td>username<br>
</td> <td>no</td> <td>admin</td> <td></td> <td> <div>Username credentials to use for auth unless <em>api_key</em> is set.</div> </td> </tr> <tr> <td>vulnerability<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Name of the already defined vulnerability profile.</div> </td> </tr> <tr> <td>wildfire_analysis<br>
</td> <td>no</td> <td>None</td> <td></td> <td> <div>Name of the already defined wildfire_analysis profile.</div> </td> </tr> </table>   <h2 id="examples">Examples</h2>  <pre data-language="YAML">- name: permit ssh to 1.1.1.1
  panos_security_policy:
    ip_address: '10.5.172.91'
    username: 'admin'
    password: 'paloalto'
    rule_name: 'SSH permit'
    description: 'SSH rule test'
    from_zone: ['public']
    to_zone: ['private']
    source: ['any']
    source_user: ['any']
    destination: ['1.1.1.1']
    category: ['any']
    application: ['ssh']
    service: ['application-default']
    hip_profiles: ['any']
    action: 'allow'
    commit: false

- name: Allow HTTP multimedia only from CDNs
  panos_security_policy:
    ip_address: '10.5.172.91'
    username: 'admin'
    password: 'paloalto'
    rule_name: 'HTTP Multimedia'
    description: 'Allow HTTP multimedia only to host at 1.1.1.1'
    from_zone: ['public']
    to_zone: ['private']
    source: ['any']
    source_user: ['any']
    destination: ['1.1.1.1']
    category: ['content-delivery-networks']
    application: ['http-video', 'http-audio']
    service: ['service-http', 'service-https']
    hip_profiles: ['any']
    action: 'allow'
    commit: false

- name: more complex fictitious rule that uses profiles
  panos_security_policy:
    ip_address: '10.5.172.91'
    username: 'admin'
    password: 'paloalto'
    rule_name: 'Allow HTTP w profile'
    log_start: false
    log_end: true
    action: 'allow'
    antivirus: 'default'
    vulnerability: 'default'
    spyware: 'default'
    url_filtering: 'default'
    wildfire_analysis: 'default'
    commit: false

- name: deny all
  panos_security_policy:
    ip_address: '10.5.172.91'
    username: 'admin'
    password: 'paloalto'
    rule_name: 'DenyAll'
    log_start: true
    log_end: true
    action: 'deny'
    rule_type: 'interzone'
    commit: false

# permit ssh to 1.1.1.1 using panorama and pushing the configuration to firewalls
# that are defined in 'DeviceGroupA' device group
- name: permit ssh to 1.1.1.1 through Panorama
  panos_security_policy:
    ip_address: '10.5.172.92'
    password: 'paloalto'
    rule_name: 'SSH permit'
    description: 'SSH rule test'
    from_zone: ['public']
    to_zone: ['private']
    source: ['any']
    source_user: ['any']
    destination: ['1.1.1.1']
    category: ['any']
    application: ['ssh']
    service: ['application-default']
    hip_profiles: ['any']
    action: 'allow'
    devicegroup: 'DeviceGroupA'
</pre>    <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <ul class="last simple"> <li>Checkmode is not supported.</li> <li>Panorama is supported</li> </ul> </div> <p>For help in developing on modules, should you be so inclined, please read <a class="reference internal" href="https://docs.ansible.com/ansible/latest/community.html" target="_blank"><span class="doc">Community Information &amp; Contributing</span></a>, <a class="reference internal" href="../dev_guide/testing/"><span class="doc">Testing Ansible</span></a> and <a class="reference internal" href="../dev_guide/developing_modules/"><span class="doc">Developing Modules</span></a>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2017 Michael DeHaan<br>© 2017 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/panos_security_policy_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/panos_security_policy_module.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
