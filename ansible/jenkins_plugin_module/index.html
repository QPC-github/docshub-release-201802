
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Jenkins_plugin - Ansible - W3cubDocs</title>
  
  <meta name="description" content=" New in version 2.2. ">
  <meta name="keywords" content="jenkins, plugin, -, add, or, remove, ansible">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ansible/jenkins_plugin_module/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-e0f881b0fce8cbe96f33dadc355b7159d5d2912911231446d60eb8f9caffa802.css">
  <script type="text/javascript" src="/assets/application-8fc46316434047265cd383f02b8e7f434ed7dec4a59f920dd633deef8d488d1b.js"></script>
  <script src="/json/ansible.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ansible/" class="_nav-link" title="" style="margin-left:0;">Ansible</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
<h1 id="jenkins-plugin">jenkins_plugin - Add or remove Jenkins plugin</h1> <div class="versionadded" id="jenkins-plugin-add-or-remove-jenkins-plugin"> <p><span class="versionmodified">New in version 2.2.</span></p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#options" id="id2">Options</a></li> <li><a class="reference internal" href="#examples" id="id3">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id4">Return Values</a></li> <li>
<a class="reference internal" href="#notes" id="id5">Notes</a><ul> <li><a class="reference internal" href="#status" id="id6">Status</a></li> </ul> </li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Ansible module which helps to manage Jenkins plugins.</li> </ul>   <h2 id="options">Options</h2> <table> <tr> <th class="head">parameter</th> <th class="head">required</th> <th class="head">default</th> <th class="head">choices</th> <th class="head">comments</th> </tr> <tr> <td>group<br>
</td> <td>no</td> <td>jenkins</td> <td></td> <td> <div>Name of the Jenkins group on the OS.</div> </td> </tr> <tr> <td>jenkins_home<br>
</td> <td>no</td> <td>/var/lib/jenkins</td> <td></td> <td> <div>Home directory of the Jenkins user.</div> </td> </tr> <tr> <td>mode<br>
</td> <td>no</td> <td>0664</td> <td></td> <td> <div>File mode applied on versioned plugins.</div> </td> </tr> <tr> <td>name<br>
</td> <td>yes</td> <td></td> <td></td> <td> <div>Plugin name.</div> </td> </tr> <tr> <td>owner<br>
</td> <td>no</td> <td>jenkins</td> <td></td> <td> <div>Name of the Jenkins user on the OS.</div> </td> </tr> <tr> <td>params<br>
</td> <td>no</td> <td></td> <td></td> <td> <div>Option used to allow the user to overwrite any of the other options. To remove an option, set the value of the option to <code>null</code>.</div> </td> </tr> <tr> <td>state<br>
</td> <td>no</td> <td>present</td> <td><ul>
<li>absent</li>
<li>present</li>
<li>pinned</li>
<li>unpinned</li>
<li>enabled</li>
<li>disabled</li>
<li>latest</li>
</ul></td> <td> <div>Desired plugin state.</div> <div>If the <code>latest</code> is set, the check for new version will be performed every time. This is suitable to keep the plugin up-to-date.</div> </td> </tr> <tr> <td>timeout<br>
</td> <td>no</td> <td>30</td> <td></td> <td> <div>Server connection timeout in secs.</div> </td> </tr> <tr> <td>updates_expiration<br>
</td> <td>no</td> <td>86400</td> <td></td> <td> <div>Number of seconds after which a new copy of the <em>update-center.json</em> file is downloaded. This is used to avoid the need to download the plugin to calculate its checksum when <code>latest</code> is specified.</div> <div>Set it to <code>0</code> if no cache file should be used. In that case, the plugin file will always be downloaded to calculate its checksum when <code>latest</code> is specified.</div> </td> </tr> <tr> <td>updates_url<br>
</td> <td>no</td> <td>https://updates.jenkins-ci.org</td> <td></td> <td> <div>URL of the Update Centre.</div> <div>Used as the base URL to download the plugins and the <em>update-center.json</em> JSON file.</div> </td> </tr> <tr> <td>url<br>
</td> <td>no</td> <td>http://localhost:8080</td> <td></td> <td> <div>URL of the Jenkins server.</div> </td> </tr> <tr> <td>version<br>
</td> <td>no</td> <td></td> <td></td> <td> <div>Plugin version number.</div> <div>If this option is specified, all plugin dependencies must be installed manually.</div> <div>It might take longer to verify that the correct version is installed. This is especially true if a specific version number is specified.</div> <div>Quote the version to prevent the value to be interpreted as float. For example if <code>1.20</code> would be unquoted, it would become <code>1.2</code>.</div> </td> </tr> <tr> <td>with_dependencies<br>
</td> <td>no</td> <td>yes</td> <td><ul>
<li>yes</li>
<li>no</li>
</ul></td> <td> <div>Defines whether to install plugin dependencies.</div> <div>This option takes effect only if the <em>version</em> is not defined.</div> </td> </tr> </table>   <h2 id="examples">Examples</h2>  <pre data-language="YAML">- name: Install plugin
  jenkins_plugin:
    name: build-pipeline-plugin

- name: Install plugin without its dependencies
  jenkins_plugin:
    name: build-pipeline-plugin
    with_dependencies: no

- name: Make sure the plugin is always up-to-date
  jenkins_plugin:
    name: token-macro
    state: latest

- name: Install specific version of the plugin
  jenkins_plugin:
    name: token-macro
    version: "1.15"

- name: Pin the plugin
  jenkins_plugin:
    name: token-macro
    state: pinned

- name: Unpin the plugin
  jenkins_plugin:
    name: token-macro
    state: unpinned

- name: Enable the plugin
  jenkins_plugin:
    name: token-macro
    state: enabled

- name: Disable the plugin
  jenkins_plugin:
    name: token-macro
    state: disabled

- name: Uninstall plugin
  jenkins_plugin:
    name: build-pipeline-plugin
    state: absent

#
# Example of how to use the params
#
# Define a variable and specify all default parameters you want to use across
# all jenkins_plugin calls:
#
# my_jenkins_params:
#   url_username: admin
#   url_password: p4ssw0rd
#   url: http://localhost:8888
#
- name: Install plugin
  jenkins_plugin:
    name: build-pipeline-plugin
    params: "{{ my_jenkins_params }}"

#
# Example of a Play which handles Jenkins restarts during the state changes
#
- name: Jenkins Master play
  hosts: jenkins-master
  vars:
    my_jenkins_plugins:
      token-macro:
        enabled: yes
      build-pipeline-plugin:
        version: "1.4.9"
        pinned: no
        enabled: yes
  tasks:
    - name: Install plugins without a specific version
      jenkins_plugin:
        name: "{{ item.key }}"
      register: my_jenkins_plugin_unversioned
      when: &gt;
        'version' not in item.value
      with_dict: "{{ my_jenkins_plugins }}"

    - name: Install plugins with a specific version
      jenkins_plugin:
        name: "{{ item.key }}"
        version: "{{ item.value['version'] }}"
      register: my_jenkins_plugin_versioned
      when: &gt;
        'version' in item.value
      with_dict: "{{ my_jenkins_plugins }}"

    - name: Initiate the fact
      set_fact:
        jenkins_restart_required: no

    - name: Check if restart is required by any of the versioned plugins
      set_fact:
        jenkins_restart_required: yes
      when: item.changed
      with_items: "{{ my_jenkins_plugin_versioned.results }}"

    - name: Check if restart is required by any of the unversioned plugins
      set_fact:
        jenkins_restart_required: yes
      when: item.changed
      with_items: "{{ my_jenkins_plugin_unversioned.results }}"

    - name: Restart Jenkins if required
      service:
        name: jenkins
        state: restarted
      when: jenkins_restart_required

    - name: Wait for Jenkins to start up
      uri:
        url: http://localhost:8080
        status_code: 200
        timeout: 5
      register: jenkins_service_status
      # Keep trying for 5 mins in 5 sec intervals
      retries: 60
      delay: 5
      until: &gt;
         'status' in jenkins_service_status and
         jenkins_service_status['status'] == 200
      when: jenkins_restart_required

    - name: Reset the fact
      set_fact:
        jenkins_restart_required: no
      when: jenkins_restart_required

    - name: Plugin pinning
      jenkins_plugin:
        name: "{{ item.key }}"
        state: "{{ 'pinned' if item.value['pinned'] else 'unpinned'}}"
      when: &gt;
        'pinned' in item.value
      with_dict: "{{ my_jenkins_plugins }}"

    - name: Plugin enabling
      jenkins_plugin:
        name: "{{ item.key }}"
        state: "{{ 'enabled' if item.value['enabled'] else 'disabled'}}"
      when: &gt;
        'enabled' in item.value
      with_dict: "{{ my_jenkins_plugins }}"
</pre>    <h2 id="return-values">Return Values</h2> <p>Common return values are documented here <a class="reference internal" href="../common_return_values/"><span class="doc">Return Values</span></a>, the following are the fields unique to this module:</p> <table> <tr> <th class="head">name</th> <th class="head">description</th> <th class="head">returned</th> <th class="head">type</th> <th class="head">sample</th> </tr> <tr> <td>state</td> <td> <div>state of the target, after execution</div> </td> <td align="center">success</td> <td align="center">string</td> <td align="center">present</td> </tr> <tr> <td>plugin</td> <td> <div>plugin name</div> </td> <td align="center">success</td> <td align="center">string</td> <td align="center">build-pipeline-plugin</td> </tr> </table>   <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="first admonition-title">Note</p> <ul class="last simple"> <li>Plugin installation should be run under root or the same user which owns the plugin files on the disk. Only if the plugin is not installed yet and no version is specified, the API installation is performed which requires only the Web UI credentials.</li> <li>It’s necessary to notify the handler or call the <em>service</em> module to restart the Jenkins service after a new plugin was installed.</li> <li>Pinning works only if the plugin is installed and Jenkis service was successfully restarted after the plugin installation.</li> <li>It is not possible to run the module remotely by changing the <em>url</em> parameter to point to the Jenkins server. The module must be used on the host where Jenkins runs as it needs direct access to the plugin files.</li> </ul> </div>  <h3 id="status">Status</h3> <p>This module is flagged as <strong>preview</strong> which means that it is not guaranteed to have a backwards compatible interface.</p> <p>For help in developing on modules, should you be so inclined, please read <a class="reference internal" href="https://docs.ansible.com/ansible/latest/community.html" target="_blank"><span class="doc">Community Information &amp; Contributing</span></a>, <a class="reference internal" href="../dev_guide/testing/"><span class="doc">Testing Ansible</span></a> and <a class="reference internal" href="../dev_guide/developing_modules/"><span class="doc">Developing Modules</span></a>.</p>
<div class="_attribution">
  <p class="_attribution-p">
    © 2012–2017 Michael DeHaan<br>© 2017 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/jenkins_plugin_module.html" class="_attribution-link" target="_blank">https://docs.ansible.com/ansible/latest/jenkins_plugin_module.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
