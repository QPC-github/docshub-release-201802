
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>sklearn.cluster.ward_tree() - Scikit-learn - W3cubDocs</title>
  
  <meta name="description" content=" Ward clustering based on a Feature matrix. ">
  <meta name="keywords" content="sklearn, cluster, ward, tree, -, scikit-learn, scikit_learn">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/scikit_learn/modules/generated/sklearn.cluster.ward_tree/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-e0f881b0fce8cbe96f33dadc355b7159d5d2912911231446d60eb8f9caffa802.css">
  <script type="text/javascript" src="/assets/application-8fc46316434047265cd383f02b8e7f434ed7dec4a59f920dd633deef8d488d1b.js"></script>
  <script src="/json/scikit_learn.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/scikit_learn/" class="_nav-link" title="" style="margin-left:0;">scikit-learn</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _sphinx">
				
<h1 id="sklearn-cluster-ward-tree">sklearn.cluster.ward_tree</h1> <dl class="function"> <dt id="sklearn.cluster.ward_tree">
<code>sklearn.cluster.ward_tree(X, connectivity=None, n_clusters=None, return_distance=False)</code> <a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/f3320a6f/sklearn/cluster/hierarchical.py#L86" target="_blank"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Ward clustering based on a Feature matrix.</p> <p>Recursively merges the pair of clusters that minimally increases within-cluster variance.</p> <p>The inertia matrix uses a Heapq-based representation.</p> <p>This is the structured version, that takes into account some topological structure between samples.</p> <p>Read more in the <a class="reference internal" href="../../clustering/#hierarchical-clustering"><span class="std std-ref">User Guide</span></a>.</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<p class="first"><strong>X</strong> : array, shape (n_samples, n_features)</p>  <p>feature matrix representing n_samples samples to be clustered</p>  <p><strong>connectivity</strong> : sparse matrix (optional).</p>  <p>connectivity matrix. Defines for each sample the neighboring samples following a given structure of the data. The matrix is assumed to be symmetric and only the upper triangular half is used. Default is None, i.e, the Ward algorithm is unstructured.</p>  <p><strong>n_clusters</strong> : int (optional)</p>  <p>Stop early the construction of the tree at n_clusters. This is useful to decrease computation time if the number of clusters is not small compared to the number of samples. In this case, the complete tree is not computed, thus the ‘children’ output is of limited use, and the ‘parents’ output should rather be used. This option is valid only when specifying a connectivity matrix.</p>  <p><strong>return_distance</strong> : bool (optional)</p>  <p>If True, return the distance between the clusters.</p>  </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first"><strong>children</strong> : 2D array, shape (n_nodes-1, 2)</p>  <p>The children of each non-leaf node. Values less than <code>n_samples</code> correspond to leaves of the tree which are the original samples. A node <code>i</code> greater than or equal to <code>n_samples</code> is a non-leaf node and has children <code>children_[i - n_samples]</code>. Alternatively at the i-th iteration, children[i][0] and children[i][1] are merged to form node <code>n_samples + i</code></p>  <p><strong>n_components</strong> : int</p>  <p>The number of connected components in the graph.</p>  <p><strong>n_leaves</strong> : int</p>  <p>The number of leaves in the tree</p>  <p><strong>parents</strong> : 1D array, shape (n_nodes, ) or None</p>  <p>The parent of each node. Only returned when a connectivity matrix is specified, elsewhere ‘None’ is returned.</p>  <p><strong>distances</strong> : 1D array, shape (n_nodes-1, )</p>  <p>Only returned if return_distance is set to True (for compatibility). The distances between the centers of the nodes. <code>distances[i]</code> corresponds to a weighted euclidean distance between the nodes <code>children[i, 1]</code> and <code>children[i, 2]</code>. If the nodes refer to leaves of the tree, then <code>distances[i]</code> is their unweighted euclidean distance. Distances are updated in the following way (from scipy.hierarchy.linkage):</p> <p>The new entry <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAASBAMAAADrvZC0AAAALVBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACttl6nAAAAD3RSTlMAi/0YdDJIYM+d3b+v8+mwrDqgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA/klEQVQY02NgAANmAQYUwAilpzJwG6DKMG8AU1kKDNMZ0IAjmGRvYHiALsMHJrkFWATQZTjBIrwBXAHoMmwLgLITnRiYgEZ6MLA0gAVTFjCrMjAoMDAsZOgAyRgyJXBMgHhAjeE5SIbxAUMjQywDQ0EQA1MC2D2sCkBvMFxmYBJgUAXJMJxgCIJYwdPAIACSCQpgU2AwAgpcYZCCyPA6gGQUGJIYOBcUAO1hUGboYQfLMBmwJYBkmAzsDgiAXK3MqhLO2gyW4QS7mv2Ia6cBI1C7jIi3AJsiUIZlI5DH6QANwAVQD7Kghg4QHEOXKYQxuKF0MWosIMWcAyzmDBgAxFAkcL5zq/cAAAAASUVORK5CYII=" alt="d(u,v)"> is computed as follows,</p> <div class="math"> <p><img src="data:image/png;base64,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" alt="d(u,v) = \sqrt{\frac{|v|+|s|}
                    {T}d(v,s)^2
             + \frac{|v|+|t|}
                    {T}d(v,t)^2
             - \frac{|v|}
                    {T}d(s,t)^2}"></p> </div>
<p>where <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAIBAMAAAAy1HOFAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAYHTPGIv7SJ0yr/PdvwNBhVYAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA2SURBVAjXY2BUZmAyYHBlK2BuYBCYx8BWwMCwmGEeAwPDJoYYIPmEwYoRSHImTWRgiArSDQAAwakJMMtEnloAAAAASUVORK5CYII=" alt="u"> is the newly joined cluster consisting of clusters <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAJ1BMVEUAAABHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB9YSk7AAAADXRSTlOLAP1I3b90YK8Yz50ybo0VWQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAC9JREFUCNdjEBRj4GEQrBCMZhBsFZzIIGikYsggKJilyCCSKAgkJgoHMogzMAgCAHCiBX7ykRrgAAAAAElFTkSuQmCC" alt="s"> and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAMBAMAAACzedEdAAAAKlBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHrpZrAAAADnRSTlMAizL9r2DdSPPpnRjPdEkVhTQAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAA2SURBVAjXY2BgKmBgYBNgYGBWYGAoZmAImeHIwJDIwMBgxMDAasDAwHIAJL2VgaNgAQOvowIAehoGKaU9U4EAAAAASUVORK5CYII=" alt="t">, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAIBAMAAADZ48iGAAAALVBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACttl6nAAAAD3RSTlMAi/5IGHQynWC/88+v3ekc2gjFAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAMElEQVQI12NgjmVwSmBwZDLga2BoSGJgT2BgOM3AyMDAsBRMqjAYg8kCIBkpyMAAAK6lBhQTPK0GAAAAAElFTkSuQmCC" alt="v"> is an unused cluster in the forest, <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAAATBAMAAABMy9NRAAAALVBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACttl6nAAAADnRSTlMA3c+LYEiv+RgydL+d6Qfwjc0AAAAJcEhZcwAADsQAAA7EAZUrDhsAAAEqSURBVDjLY2DABBxQugGLIBaxBixGMDBCaQEsgljEBBiYi9LK09Q3kGsGZwBQiKmBoYyBxQC3GawTMM1AiDEaAIVmMXA+YWB1wG0GswOmGQgxvglAoQUMzA8YWBrINSMcIsR0ASNMWRcytE/AUM9lbIku5nY9GSzEfgDDjGb2AF4HDDPcGPZgiAlD3DEvACzArQQCCWAph3kMPJjuyAYmBXSxlxAzzmFJH0kMzBDJTUq6l5TUIIJxDwPQxVgKIMoEsZhRBTMDJUwXFaCLsSlAlL1hwPALwwuGUAwzGBcwYJjBaNACEmJ9isUdLxgOYJrRwLoBXYw94ABQiGf7w0xMM1YbY6YFFmNjDDGu5AmoyR97GuMKwExjKGICVMm3g9gMJiitgEUQi5gCAK2lOUPvQfERAAAAAElFTkSuQmCC" alt="T=|v|+|s|+|t|">, and <img class="math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAATBAMAAAB4ntAIAAAAJ1BMVEUAAABHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB9YSk7AAAADXRSTlPdAM8Yr/WdYIvpMki/JgGJkAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAEBJREFUCNdjMBSEA2EGRgRHgCSOCDJHFImjIiTBCOeIKakZIpSlOiOUte5Z6QjnFEoKFmI3TVCYDLfBOIoIjhAAdDoRz/X4ltIAAAAASUVORK5CYII=" alt="|*|"> is the cardinality of its argument. This is also known as the incremental algorithm.</p>  </td> </tr>  </table> </dd>
</dl> <div class="_attribution">
  <p class="_attribution-p">
    © 2007–2017 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cluster.ward_tree.html" class="_attribution-link" target="_blank">http://scikit-learn.org/stable/modules/generated/sklearn.cluster.ward_tree.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
	<svg style="display:none">
		<symbol id="icon-dir"><svg viewBox="0 0 20 20"><path d="M15 10c0 .3-.305.515-.305.515l-8.56 5.303c-.625.41-1.135.106-1.135-.67V4.853c0-.777.51-1.078 1.135-.67l8.56 5.305S15 9.702 15 10z"/></svg></symbol>
	  </svg>
</body>
</html>
